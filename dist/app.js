(()=>{var be=Object.create;var Ht=Object.defineProperty;var Ae=Object.getOwnPropertyDescriptor;var Ee=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,we=Object.prototype.hasOwnProperty;var k=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Te=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ee(t))!we.call(r,i)&&i!==e&&Ht(r,i,{get:()=>t[i],enumerable:!(n=Ae(t,i))||n.enumerable});return r};var Wt=(r,t,e)=>(e=r!=null?be(ye(r)):{},Te(t||!r||!r.__esModule?Ht(e,"default",{value:r,enumerable:!0}):e,r));var Kt=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var a=(r,t,e)=>(Kt(r,t,"read from private field"),e?e.call(r):t.get(r)),u=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},h=(r,t,e,n)=>(Kt(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e);var lt=k(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.AttributeAction=y.IgnoreCaseMode=y.SelectorType=void 0;var Pe;(function(r){r.Attribute="attribute",r.Pseudo="pseudo",r.PseudoElement="pseudo-element",r.Tag="tag",r.Universal="universal",r.Adjacent="adjacent",r.Child="child",r.Descendant="descendant",r.Parent="parent",r.Sibling="sibling",r.ColumnCombinator="column-combinator"})(Pe=y.SelectorType||(y.SelectorType={}));y.IgnoreCaseMode={Unknown:null,QuirksMode:"quirks",IgnoreCase:!0,CaseSensitive:!1};var Se;(function(r){r.Any="any",r.Element="element",r.End="end",r.Equals="equals",r.Exists="exists",r.Hyphen="hyphen",r.Not="not",r.Start="start"})(Se=y.AttributeAction||(y.AttributeAction={}))});var Qt=k(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.parse=G.isTraversal=void 0;var l=lt(),Yt=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,Ne=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Le=new Map([[126,l.AttributeAction.Element],[94,l.AttributeAction.Start],[36,l.AttributeAction.End],[42,l.AttributeAction.Any],[33,l.AttributeAction.Not],[124,l.AttributeAction.Hyphen]]),Oe=new Set(["has","not","matches","is","where","host","host-context"]);function zt(r){switch(r.type){case l.SelectorType.Adjacent:case l.SelectorType.Child:case l.SelectorType.Descendant:case l.SelectorType.Parent:case l.SelectorType.Sibling:case l.SelectorType.ColumnCombinator:return!0;default:return!1}}G.isTraversal=zt;var Me=new Set(["contains","icontains"]);function Re(r,t,e){var n=parseInt(t,16)-65536;return n!==n||e?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function Q(r){return r.replace(Ne,Re)}function gt(r){return r===39||r===34}function Vt(r){return r===32||r===9||r===10||r===12||r===13}function De(r){var t=[],e=kt(t,"".concat(r),0);if(e<r.length)throw new Error("Unmatched selector: ".concat(r.slice(e)));return t}G.parse=De;function kt(r,t,e){var n=[];function i(d){var g=t.slice(e+d).match(Yt);if(!g)throw new Error("Expected name, found ".concat(t.slice(e)));var Ut=g[0];return e+=d+Ut.length,Q(Ut)}function s(d){for(e+=d;e<t.length&&Vt(t.charCodeAt(e));)e++}function c(){e+=1;for(var d=e,g=1;g>0&&e<t.length;e++)t.charCodeAt(e)===40&&!b(e)?g++:t.charCodeAt(e)===41&&!b(e)&&g--;if(g)throw new Error("Parenthesis not matched");return Q(t.slice(d,e-1))}function b(d){for(var g=0;t.charCodeAt(--d)===92;)g++;return(g&1)===1}function Rt(){if(n.length>0&&zt(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function V(d){if(n.length>0&&n[n.length-1].type===l.SelectorType.Descendant){n[n.length-1].type=d;return}Rt(),n.push({type:d})}function Dt(d,g){n.push({type:l.SelectorType.Attribute,name:d,action:g,value:i(1),namespace:null,ignoreCase:"quirks"})}function Ft(){if(n.length&&n[n.length-1].type===l.SelectorType.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");r.push(n)}if(s(0),t.length===e)return e;t:for(;e<t.length;){var mt=t.charCodeAt(e);switch(mt){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==l.SelectorType.Descendant)&&(Rt(),n.push({type:l.SelectorType.Descendant})),s(1);break}case 62:{V(l.SelectorType.Child),s(1);break}case 60:{V(l.SelectorType.Parent),s(1);break}case 126:{V(l.SelectorType.Sibling),s(1);break}case 43:{V(l.SelectorType.Adjacent),s(1);break}case 46:{Dt("class",l.AttributeAction.Element);break}case 35:{Dt("id",l.AttributeAction.Equals);break}case 91:{s(1);var B=void 0,O=null;t.charCodeAt(e)===124?B=i(1):t.startsWith("*|",e)?(O="*",B=i(2)):(B=i(0),t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==61&&(O=B,B=i(1))),s(0);var ut=l.AttributeAction.Exists,jt=Le.get(t.charCodeAt(e));if(jt){if(ut=jt,t.charCodeAt(e+1)!==61)throw new Error("Expected `=`");s(2)}else t.charCodeAt(e)===61&&(ut=l.AttributeAction.Equals,s(1));var dt="",Ct=null;if(ut!=="exists"){if(gt(t.charCodeAt(e))){for(var Bt=t.charCodeAt(e),M=e+1;M<t.length&&(t.charCodeAt(M)!==Bt||b(M));)M+=1;if(t.charCodeAt(M)!==Bt)throw new Error("Attribute value didn't end");dt=Q(t.slice(e+1,M)),e=M+1}else{for(var ge=e;e<t.length&&(!Vt(t.charCodeAt(e))&&t.charCodeAt(e)!==93||b(e));)e+=1;dt=Q(t.slice(ge,e))}s(0);var Gt=t.charCodeAt(e)|32;Gt===115?(Ct=!1,s(1)):Gt===105&&(Ct=!0,s(1))}if(t.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;var ve={type:l.SelectorType.Attribute,name:B,action:ut,value:dt,namespace:O,ignoreCase:Ct};n.push(ve);break}case 58:{if(t.charCodeAt(e+1)===58){n.push({type:l.SelectorType.PseudoElement,name:i(2).toLowerCase(),data:t.charCodeAt(e)===40?c():null});continue}var z=i(1).toLowerCase(),A=null;if(t.charCodeAt(e)===40)if(Oe.has(z)){if(gt(t.charCodeAt(e+1)))throw new Error("Pseudo-selector ".concat(z," cannot be quoted"));if(A=[],e=kt(A,t,e+1),t.charCodeAt(e)!==41)throw new Error("Missing closing parenthesis in :".concat(z," (").concat(t,")"));e+=1}else{if(A=c(),Me.has(z)){var _t=A.charCodeAt(0);_t===A.charCodeAt(A.length-1)&&gt(_t)&&(A=A.slice(1,-1))}A=Q(A)}n.push({type:l.SelectorType.Pseudo,name:z,data:A});break}case 44:{Ft(),n=[],s(1);break}default:{if(t.startsWith("/*",e)){var qt=t.indexOf("*/",e+2);if(qt<0)throw new Error("Comment was not terminated");e=qt+2,n.length===0&&s(0);break}var O=null,N=void 0;if(mt===42)e+=1,N="*";else if(mt===124){if(N="",t.charCodeAt(e+1)===124){V(l.SelectorType.ColumnCombinator),s(2);break}}else if(Yt.test(t.slice(e)))N=i(0);else break t;t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==124&&(O=N,t.charCodeAt(e+1)===42?(N="*",e+=2):N=i(1)),n.push(N==="*"?{type:l.SelectorType.Universal,namespace:O}:{type:l.SelectorType.Tag,name:N,namespace:O})}}}return Ft(),e}});var te=k(q=>{"use strict";var ht=q&&q.__spreadArray||function(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(q,"__esModule",{value:!0});q.stringify=void 0;var f=lt(),Jt=["\\",'"'],Zt=ht(ht([],Jt,!0),["(",")"],!1),Fe=new Set(Jt.map(function(r){return r.charCodeAt(0)})),Xt=new Set(Zt.map(function(r){return r.charCodeAt(0)})),_=new Set(ht(ht([],Zt,!0),["~","^","$","*","+","!","|",":","[","]"," ","."],!1).map(function(r){return r.charCodeAt(0)}));function xt(r){return r.map(function(t){return t.map(je).join("")}).join(", ")}q.stringify=xt;function je(r,t,e){switch(r.type){case f.SelectorType.Child:return t===0?"> ":" > ";case f.SelectorType.Parent:return t===0?"< ":" < ";case f.SelectorType.Sibling:return t===0?"~ ":" ~ ";case f.SelectorType.Adjacent:return t===0?"+ ":" + ";case f.SelectorType.Descendant:return" ";case f.SelectorType.ColumnCombinator:return t===0?"|| ":" || ";case f.SelectorType.Universal:return r.namespace==="*"&&t+1<e.length&&"name"in e[t+1]?"":"".concat(It(r.namespace),"*");case f.SelectorType.Tag:return $t(r);case f.SelectorType.PseudoElement:return"::".concat(w(r.name,_)).concat(r.data===null?"":"(".concat(w(r.data,Xt),")"));case f.SelectorType.Pseudo:return":".concat(w(r.name,_)).concat(r.data===null?"":"(".concat(typeof r.data=="string"?w(r.data,Xt):xt(r.data),")"));case f.SelectorType.Attribute:{if(r.name==="id"&&r.action===f.AttributeAction.Equals&&r.ignoreCase==="quirks"&&!r.namespace)return"#".concat(w(r.value,_));if(r.name==="class"&&r.action===f.AttributeAction.Element&&r.ignoreCase==="quirks"&&!r.namespace)return".".concat(w(r.value,_));var n=$t(r);return r.action===f.AttributeAction.Exists?"[".concat(n,"]"):"[".concat(n).concat(Be(r.action),'="').concat(w(r.value,Fe),'"').concat(r.ignoreCase===null?"":r.ignoreCase?" i":" s","]")}}}function Be(r){switch(r){case f.AttributeAction.Equals:return"";case f.AttributeAction.Element:return"~";case f.AttributeAction.Start:return"^";case f.AttributeAction.End:return"$";case f.AttributeAction.Any:return"*";case f.AttributeAction.Not:return"!";case f.AttributeAction.Hyphen:return"|";case f.AttributeAction.Exists:throw new Error("Shouldn't be here")}}function $t(r){return"".concat(It(r.namespace)).concat(w(r.name,_))}function It(r){return r!==null?"".concat(r==="*"?"*":w(r,_),"|"):""}function w(r,t){for(var e=0,n="",i=0;i<r.length;i++)t.has(r.charCodeAt(i))&&(n+="".concat(r.slice(e,i),"\\").concat(r.charAt(i)),e=i+1);return n.length>0?n+r.slice(e):r}});var re=k(C=>{"use strict";var Ge=C&&C.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,i)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),_e=C&&C.__exportStar||function(r,t){for(var e in r)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Ge(t,r,e)};Object.defineProperty(C,"__esModule",{value:!0});C.stringify=C.parse=C.isTraversal=void 0;_e(lt(),C);var ee=Qt();Object.defineProperty(C,"isTraversal",{enumerable:!0,get:function(){return ee.isTraversal}});Object.defineProperty(C,"parse",{enumerable:!0,get:function(){return ee.parse}});var qe=te();Object.defineProperty(C,"stringify",{enumerable:!0,get:function(){return qe.stringify}})});var vt=k(o=>{"use strict";var ct,Ue=o&&o.__classPrivateFieldSet||function(r,t,e,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,e):i?i.value=e:t.set(r,e),e},He=o&&o.__classPrivateFieldGet||function(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)};Object.defineProperty(o,"__esModule",{value:!0}),o.Element=o.t=o.s=o.removeClass=o.onEach=o.once=o.on=o.off=o.hasClass=o.h=o.empty=o.emitCustom=o.emit=o.addClass=void 0;var We=re();o.addClass=(r,...t)=>r.classList.add(...t);o.emit=(r,t)=>r.dispatchEvent(t);o.emitCustom=(r,t,...e)=>(0,o.emit)(r,new CustomEvent(t,{detail:e}));o.empty=r=>{for(var t;r.hasChildNodes();)(t=r.firstChild)===null||t===void 0||t.remove()};o.h=(r,...t)=>{let[e]=(0,We.parse)(r).map(n=>n.reduce((i,s)=>{var c;return s.type==="tag"?document.createElement(s.name):(s.type==="attribute"&&s.name!=="class"&&i.setAttribute(s.name,(c=s.value)!==null&&c!==void 0?c:""),s.type==="attribute"&&s.name==="class"&&i.classList.add(s.value),i)},document.createElement("div")));return t.forEach(n=>{n instanceof T&&(n=n.element()),e.append(n)}),e};o.hasClass=(r,t)=>r.classList.contains(t);o.off=(r,t,e,n={})=>r.removeEventListener(t,e,n);o.on=(r,t,e,n={})=>r.addEventListener(t,e,n);o.once=(r,t,e,n={})=>(0,o.on)(r,t,e,Object.assign(Object.assign({},typeof n=="boolean"?{capture:n}:n),{once:!0}));o.onEach=(r,t,e,n={})=>t.forEach(i=>(0,o.on)(r,i,e,n));o.removeClass=(r,...t)=>r.classList.remove(...t);o.s=r=>{let t=document.createElement("div");return t.innerHTML=r,t.firstElementChild};o.t=r=>document.createTextNode(r);var T=class{constructor(t){ct.set(this,void 0),Ue(this,ct,t,"f")}static fromSelector(t,...e){return new T((0,o.h)(t,...e))}static fromString(t){return new T((0,o.s)(t))}addClass(...t){(0,o.addClass)(this.element(),...t)}append(...t){t.forEach(e=>{e instanceof T&&(e=e.element()),this.element().append(e)})}element(){return He(this,ct,"f")}emit(t){return(0,o.emit)(this.element(),t)}emitCustom(t,...e){return(0,o.emitCustom)(this.element(),t,...e)}empty(){(0,o.empty)(this.element())}hasClass(t){return(0,o.hasClass)(this.element(),t)}on(t,e,n={}){(0,o.on)(this.element(),t,e,n)}off(t,e,n={}){(0,o.off)(this.element(),t,e,n)}once(t,e,n={}){(0,o.once)(this.element(),t,e,n)}onEach(t,e,n={}){(0,o.onEach)(this.element(),t,e,n)}query(t){return this.element().querySelector(t)}queryAll(t){return this.element().querySelectorAll(t)}removeClass(...t){(0,o.removeClass)(this.element(),...t)}};o.Element=T,ct=new WeakMap,o.default=T});var ne=Wt(vt()),R=Wt(vt()),bt=class extends ne.default{attr(t,e=""){this.element().setAttribute(t,e)}removeAttr(t){!this.element().hasAttribute(t)||this.element().removeAttribute(t)}},ft=bt;var ie={[1]:"red",[2]:"green",[4]:"blue",[8]:"yellow",[16]:"orange",[32]:"light-blue",[64]:"pink",[128]:"maroon",[256]:"purple",[512]:"white",[1024]:"grey",[2048]:"light-green",[4096]:"beige",[8192]:"dark-blue",[16384]:"teal",[32768]:"dark-pink"},ae=r=>Object.entries(ie).filter(([t])=>r&parseInt(t,10)).map(([,t])=>t),se=Object.values(ie);var X,P,$,At=class extends ft{constructor(e){super((0,R.h)(".cell"));u(this,X,null);u(this,P,[]);u(this,$,void 0);h(this,$,e),this.attr("data-i",e.toString())}colour(){return a(this,X)}index(){return a(this,$)}setColour(e){h(this,X,e),this.removeClass(...se),e!==null&&this.addClass(...ae(e))}addConnection(e){a(this,P).includes(e)||(a(this,P).push(e),this.attr("data-"+e))}clearConnections(){a(this,P).splice(0,a(this,P).length).forEach(e=>this.removeAttr("data-"+e))}dropConnection(e){let n=a(this,P).indexOf(e);n!==-1&&(a(this,P).splice(n,1),this.removeAttr("data-"+e))}setFinal(e){if(e){this.attr("data-final");return}this.removeAttr("data-final")}};X=new WeakMap,P=new WeakMap,$=new WeakMap;var U=At;var Et=class extends U{constructor(t,e){super(t),super.setColour(e),this.attr("data-id",e.toString()),this.attr("data-point")}setColour(t){throw new TypeError("Cannot change the colour of a Point")}},m=Et;var yt=class extends U{constructor(t){super(t),this.addClass("wall")}},pt=yt;var Tt=(r,t,e,n)=>{let i=r.index()%n-t.index()%n,s=Math.floor(r.index()/n)-Math.floor(t.index()/n);return i===-1&&s===0?"l":i===1&&s===0?"r":i===0&&s===-1?"t":i===0&&s===1?"b":!1};var p,H,D,F,Pt=class{constructor(t,e){u(this,p,[]);u(this,H,void 0);u(this,D,void 0);u(this,F,0);h(this,H,t),h(this,D,e)}breakAt(t){if(!this.includes(t))return;let e=a(this,p).indexOf(t),n=a(this,p).slice(0,e);for(a(this,p).slice(e).length>n.length&&this.first()instanceof m&&this.last()instanceof m&&a(this,p).reverse();this.last()!==t;)this.pop()}canAdd(t){if(t instanceof pt)return!1;let e=this.last();return e===null?t instanceof m:this.complete()?!1:this.isNeighbour(e,t)&&(!(t instanceof m)||t.colour()===this.colour())}clear(){for(;this.last();)this.pop()}clone(t=0){let e=new Pt(this.colour(),a(this,D));return h(e,F,t),h(e,p,a(this,p).slice(0)),e}colour(){return a(this,H)}complete(){let t=this.first(),e=this.last();return this.length()>1&&t&&e&&t!==e&&t instanceof m&&e instanceof m}first(){return this.length()===0?null:a(this,p)[0]}includes(t){return a(this,p).includes(t)}intersects(t){return a(this,p).some(e=>t.includes(e))}isNeighbour(t,e){return Tt(t,e,a(this,D).height(),a(this,D).width())}last(){return this.length()===0?null:a(this,p)[this.length()-1]}length(){return a(this,p).length}path(){return a(this,p)}pop(){if(this.length()===0)return;let t=this.complete(),e=a(this,p).pop(),n=this.last();e instanceof m||e.setColour(null),e.setFinal(!1),n&&(n.dropConnection(this.isNeighbour(e,n)),e.dropConnection(this.isNeighbour(n,e))),t&&(e.setFinal(!1),a(this,p).forEach(i=>i.setFinal(!1)),this.setStatus(0))}push(t){let e=this.last();e&&!this.canAdd(t)||(a(this,p).push(t),t instanceof m||t.setColour(a(this,H)),e&&(e.addConnection(this.isNeighbour(t,e)),t.addConnection(this.isNeighbour(e,t))))}setStatus(t){if(!(a(this,F)===2||t===1)){if(h(this,F,t),t===0){a(this,p).forEach(e=>e.setFinal(!1));return}a(this,p).forEach(e=>e.setFinal(!0))}}status(){return a(this,F)}},wt=Pt;p=new WeakMap,H=new WeakMap,D=new WeakMap,F=new WeakMap;var oe=wt;var ue=(r,t=[])=>({cell:r,stack:t}),L,J,Z,W,K,x,j,I,St=class{constructor(t,e,n){u(this,L,[]);u(this,J,void 0);u(this,Z,void 0);u(this,W,void 0);u(this,K,new Map);u(this,x,[]);u(this,j,[]);u(this,I,void 0);h(this,Z,e),h(this,W,t),h(this,I,n),h(this,J,t.cells()),a(this,j).push(ue(e))}generate(){for(;a(this,j).length;){let t=a(this,j).shift(),{cell:e}=t;a(this,x).includes(e)||(this.neighboursOf(e).forEach(n=>{if(n instanceof m&&a(this,Z).colour()!==n.colour()||t.stack.includes(n))return;let i=ue(n,[...t.stack,e]);if(n===a(this,I)){a(this,L).push(i.stack);return}a(this,j).push(i)}),a(this,x).push(e))}}isNeighbour(t,e){return Tt(t,e,a(this,W).height(),a(this,W).width())}isPathAvailable(){return a(this,L).length===0&&this.generate(),a(this,L).length>0}neighboursOf(t){return a(this,K).has(t)||a(this,K).set(t,a(this,J).filter(e=>this.isNeighbour(t,e)!==!1)),a(this,K).get(t)}shortestPath(){a(this,L).length===0&&this.generate();let[t]=a(this,L).sort((e,n)=>e.length-n.length);return t}};L=new WeakMap,J=new WeakMap,Z=new WeakMap,W=new WeakMap,K=new WeakMap,x=new WeakMap,j=new WeakMap,I=new WeakMap;var le=St;var tt,E,Nt=class{constructor(t){u(this,tt,void 0);u(this,E,[]);h(this,tt,t)}commit(){this.getAllByStatus(0).forEach(t=>{this.removeAllByColour(t.colour(),t),t.setStatus(t.complete()?2:1)})}create(t){let e=new oe(t,a(this,tt));return a(this,E).push(e),e}getAllByCell(t){return a(this,E).filter(e=>e.includes(t))}getAllByColour(t){return a(this,E).filter(e=>e.colour()===t)}getAllByStatus(t){return a(this,E).filter(e=>e.status()===t)}getIntersectingPaths(t){return a(this,E).filter(e=>e===t?!1:t.intersects(e))}getOrCreateByColourAndStatus(t,e=0){let n=this.getAllByColour(t);if(n.length===0)return this.create(t);let[i]=n.filter(c=>c.status()===e);if(i)return i;let s=n[0].clone();return a(this,E).push(s),s}remove(t){let e=a(this,E).indexOf(t);e!==-1&&a(this,E).splice(e,1)}removeAllByColour(t,...e){this.getAllByColour(t).forEach(n=>{e.includes(n)||this.remove(n)})}};tt=new WeakMap,E=new WeakMap;var he=Nt;var Y,et,v,S,rt,nt,Lt=class extends ft{constructor(e,n,i=[]){super((0,R.h)(".grid"));u(this,Y,new Map);u(this,et,[]);u(this,v,null);u(this,S,void 0);u(this,rt,void 0);u(this,nt,void 0);h(this,S,new he(this)),this.setSize(e,n),i.forEach(s=>{a(this,Y).set(s.element(),s),s instanceof m&&!a(this,et).includes(s.colour())&&a(this,et).push(s.colour()),this.append(s)}),this.bindEvents()}bindEvents(){this.on("pointerdown",e=>{if(!e.isPrimary)return;e.preventDefault();let n=this.cellFromEvent(e);if(n===null)return;let i=this.pathFromCell(n);if(i&&n instanceof m&&(i.last()===n||i.first()===n)&&(i.clear(),i.push(n)),i&&i.last()!==n&&i.breakAt(n),i){h(this,v,i),i.setStatus(0);return}if(!(n instanceof m))return;let s=a(this,S).getOrCreateByColourAndStatus(n.colour());s.clear(),h(this,v,s),s.push(n)}),this.on("pointerenter",e=>{if(!e.isPrimary)return;let n=this.cellFromEvent(e),i=a(this,v);n===null||i===null||i.status()===2&&!i.includes(n)||this.handleAddCellToCurrentPath(n)},{capture:!0}),this.on("pointerup",()=>{a(this,v)!==null&&(a(this,v).length()<2&&(a(this,v).clear(),a(this,S).remove(a(this,v))),a(this,S).commit(),h(this,v,null))})}cells(){return Array.from(a(this,Y).values())}cellFromEvent(e){var n;return(n=a(this,Y).get(document.elementFromPoint(e instanceof TouchEvent?e.touches[0].pageX:e.pageX,e instanceof TouchEvent?e.touches[0].pageY:e.pageY)))!=null?n:null}handleAddCellToCurrentPath(e){let n=a(this,v),i=this.pathFromCell(e,n);if(i&&i!==n&&!(e instanceof m)&&(i.breakAt(e),i.pop()),n.includes(e)&&n.last()!==e&&n.breakAt(e),n.canAdd(e)){n.push(e);return}let s=n.last();if(!s)return;let c=new le(this,s,e);c.isPathAvailable()&&c.shortestPath().forEach(b=>this.handleAddCellToCurrentPath(b))}height(){return a(this,rt)}pathFromCell(e,n=null,i=0){let s=[],c=[];if(a(this,S).getAllByCell(e).forEach(b=>{if(!(n&&b===n)){if(b.status()===i){s.push(b);return}c.push(b)}}),s.length===1)return s[0];if(s.length>1)throw new Error("Logic missing");if(c.length===1)return a(this,S).getOrCreateByColourAndStatus(c[0].colour());if(c.length>1)throw new Error("Logic missing");return null}setSize(e,n){h(this,rt,e),h(this,nt,n),this.element().style.setProperty("--height",e.toString()),this.element().style.setProperty("--width",n.toString())}width(){return a(this,nt)}};Y=new WeakMap,et=new WeakMap,v=new WeakMap,S=new WeakMap,rt=new WeakMap,nt=new WeakMap;var ce=Lt;var it,at,st,Ot=class{constructor(t,e,n){u(this,it,void 0);u(this,at,void 0);u(this,st,void 0);h(this,it,n),h(this,at,t),h(this,st,e)}generate(){let t=new Array(a(this,at)*a(this,st)).fill(null),e=Object.keys(t);return new Array(a(this,it)).fill(null).flatMap((i,s)=>[s+1,s+1]).forEach(i=>{let s=e[Math.floor(e.length*Math.random())];t[s]=i;let c=e.indexOf(s);e.splice(c,1)}),t}};it=new WeakMap,at=new WeakMap,st=new WeakMap;var fe=Ot;var pe=[[8,8,"2b7gfe5d10d1f3b1g2e1c2ca1h3a5h"]];var me=(r,t,e)=>{let n=e.match(/\d+|[a-z#]/gi);if(n===null)throw new TypeError("Invalid level definition");let i=n.flatMap(c=>/^\d+$/.test(c)?new Array(parseInt(c)).fill(null):["#"].includes(c)?c:Math.pow(2,parseInt(c,36)-10)),s=r*t;return i.length<s&&i.push(...new Array(s-i.length).fill(null)),[r,t,i]},ot,Mt=class{constructor(t){u(this,ot,void 0);h(this,ot,t)}generate(t=-1,e=-1,n=2){return me(...pe[Math.floor(Math.random()*pe.length)])}fromURL(){let[t,e,n]=JSON.parse(atob(a(this,ot).hash.slice(1)));return me(t,e,n)}random(t,e){let n=new fe(t,e,Math.floor(Math.sqrt(t*e)));return[t,e,n.generate()]}};ot=new WeakMap;var de=Mt;var Ce=new de(location),[Ye,Ve,ze]=location.hash.length>1?Ce.fromURL():Ce.generate(7,5),ke=new ce(Ye,Ve,ze.map((r,t)=>r===null?new U(t):r==="#"?new pt(t):new m(t,r))),Qe=document.getElementById("app");Qe.append(ke.element());})();
//# sourceMappingURL=app.js.map
